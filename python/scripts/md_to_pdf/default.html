<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>
    <style>{css_content}</style>
    
    <!-- KaTeX CSS y JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    
    <!-- Mermaid JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
</head>
<body>
{html_body}

<script>
// Configuración de Mermaid
mermaid.initialize({{
    startOnLoad: false,
    theme: 'default',
    securityLevel: 'loose',
    flowchart: {{
        useMaxWidth: true,
        htmlLabels: true
    }}
}});

// Configuración de KaTeX
document.addEventListener('DOMContentLoaded', function() {{
    // Renderizar fórmulas LaTeX
    renderMathInElement(document.body, {{
        delimiters: [
            {{left: '$$', right: '$$', display: true}},
            {{left: '$', right: '$', display: false}},
            {{left: '\\[', right: '\\]', display: true}},
            {{left: '\\(', right: '\\)', display: false}}
        ],
        throwOnError: false,
        errorColor: '#cc0000',
        strict: 'warn'
    }});
    
    // Renderizar diagramas Mermaid
    mermaid.run({{
        nodes: document.querySelectorAll('.language-mermaid')
    }});
}});
</script>
</body>
</html>